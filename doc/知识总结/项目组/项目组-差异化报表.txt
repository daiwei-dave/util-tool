






jira:CDDEV-20468

gsxx 分部集合表
bm   门店集合表
rtrycxf  销售金额、销售数量集合表
是否需要分页，当前接口文档没有






一。二级分部报表


1、销售总额
销售金额之和



2.筛选
入参：全部权限入参可变，只有部分权限，只传一个大区不考虑入参


3.表格数据

销售金额：
占比：销售金额/整个的销售金额	

4.金额计算






销售金额


SELECT
	b.xsdm AS affiliateBranchID,
	b.xsmc AS affiliateBranch,
	b.xszdm AS id,
	b.xszmc AS name,
	A .xsje AS salesAmount
FROM
	rtrycxf A,
	gsxx b
WHERE
	A .cxflx = 1
AND A .jzrq = TRUNC (SYSDATE, 'dd')
AND A .gsxx01 = b.gsxx01			

二。二级分部下的门店报表

1.销售总额
二级分部下的各门店之和 ？

2.表格数据


3.金额计算



销售金额     
SELECT
	s.STORE_ID AS ID,
	s.STORE_NAME AS NAME,
	"SUM" (A .xsje) AS salesAmount,
	"SUM" (A .xssl) AS salesNum,
	ROW_NUMBER () OVER (ORDER BY "SUM"(A .xsje) DESC) RANK
FROM
	rtrycxf A,
	gsxx b,
	bm c RIGHT JOIN H_STORE s
	ON c.DZBM01=s.STORE_ID
WHERE
	A .cxflx = 1
AND A .jzrq = TRUNC (SYSDATE, 'dd')
AND A .bm01 = c.bm01
AND A .gsxx01 = b.gsxx01
AND s.BRANCH_2_ID='S06'
GROUP BY
	s.STORE_ID,
	s.STORE_NAME
UNION
SELECT
	'总计' AS ID,
	NULL AS NAME,
	"SUM" (A .xsje) AS salesAmount,
	"SUM" (A .xssl) AS salesNum,
	NULL AS RANK
FROM
	rtrycxf A,
	gsxx b,
	bm c RIGHT JOIN H_STORE s
	ON c.DZBM01=s.STORE_ID
WHERE
	A .cxflx = 1
AND A .jzrq = TRUNC (SYSDATE, 'dd')
AND A .bm01 = c.bm01
AND A .gsxx01 = b.gsxx01
AND s.BRANCH_2_ID='S06'





文档的计算方法

销售金额


select b.xsdm as fbdm,b.xsmc as fbmc,b.xszdm as ejdm,b.xszmc as ejmc,c.dzbm01 as mddm,c.bmmc as mdmc,											
e.sybdm as pldm,e.sybmc as plmc,f.ppb01 as ppdm,f.ppbmc as ppmc,											
d.spxx01 as spdm,d.spmc as spmc,											
a.xsje,a.xssl											
from rtrycxf a,gsxx b,bm c,spxx d,spfl e,ppb f											
where a.cxflx = 1 and a.jzrq = trunc(sysdate,'dd')											
and a.gsxx01 = b.gsxx01											
and a.bm01 = c.bm01											
and  a.spxx01 = d.spxx01											
and d.spfl01 = e.spfl01 											
and d.ppb01 = f.ppb01	






整个的销售金额		



select b.xsdm as fbdm,b.xsmc as fbmc,b.xszdm as ejdm,b.xszmc as ejmc,c.dzbm01 as mddm,c.bmmc as mdmc,											
e.sybdm as pldm,e.sybmc as plmc,f.ppb01 as ppdm,f.ppbmc as ppmc,											
d.spxx01 as spdm,d.spmc as spmc,											
a.xsje,a.xssl											
from rtcxf a,gsxx b,bm c,spxx d,spfl e,ppb f											
where a.jzrq = trunc(sysdate,'dd')											
and a.gsxx01 = b.gsxx01											
and a.bm01 = c.bm01											
and  a.spxx01 = d.spxx01											
and d.spfl01 = e.spfl01 											
and d.ppb01 = f.ppb01											





								
